---
title: "Analiza czynników wpływających na wyniki uczniów - raport z analizy danych"
author: "Przemysław Peplinski, Wiktor Galewski, Piotr Ksepko, Aleksandra Wiśniewska"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(validate)
library(dlookr)
library(plotly)

dane <- read_csv("czynniki.csv")



```

# 1. Data Wrangling

Badanym zbiorem danych jest zestaw Czynniki, który opisuje czynniki wpływające na wyniki uczniów.

## 1.1. Analiza wstępna

```{r}
dane
str(dane)
```

Zestaw ten posiada 20 zmiennych oraz 6607 obserwacji.

## 1.2. Czyszczenie danych

Dane ogólnie rzecz biorąc nie wymagają dużo oczyszczania, nazwy zmiennych nie zawierają spacji ani polskich znaków, a obserwacje są zapisane w poprawny sposób. Zmienne jakościowe można jednak zmienić na typ factor, w celu ułatwienia analizy.

### 1.2.1. Zmiana typu zmiennych ilościowych na typ factor

Poniższy kod został wykorzystany, aby zmienić typ zmiennych ilościowych z typu character na typ factor.

```{r}
dane$Parental_Involvement <- ifelse(dane$Parental_Involvement == "Low", 1,
                                    ifelse(dane$Parental_Involvement == "Medium", 2, 3))
dane$Parental_Involvement <- factor(dane$Parental_Involvement, levels = c(1, 2, 3),
                                    labels = c("Low", "Medium", "High"), ordered = TRUE)

dane$Access_to_Resources <- ifelse(dane$Access_to_Resources == "Low", 1,
                                   ifelse(dane$Access_to_Resources == "Medium", 2, 3))
dane$Access_to_Resources <- factor(dane$Access_to_Resources, levels = c(1, 2, 3),
                                   labels = c("Low", "Medium", "High"), ordered = TRUE)

dane$Extracurricular_Activities <- ifelse(dane$Extracurricular_Activities == "No", 0, 1)
dane$Extracurricular_Activities <- factor(dane$Extracurricular_Activities, levels = c(0, 1),
                                          labels = c("No", "Yes"))

dane$Motivation_Level <- ifelse(dane$Motivation_Level == "Low", 1,
                                ifelse(dane$Motivation_Level == "Medium", 2, 3))
dane$Motivation_Level <- factor(dane$Motivation_Level, levels = c(1, 2, 3),
                                labels = c("Low", "Medium", "High"), ordered = TRUE)

dane$Internet_Access <- ifelse(dane$Internet_Access == "No", 0, 1)
dane$Internet_Access <- factor(dane$Internet_Access, levels = c(0, 1), labels = c("No", "Yes"))

dane$Family_Income <- ifelse(is.na(dane$Family_Income), NA,
                             ifelse(dane$Family_Income == "Low", 1,
                                    ifelse(dane$Family_Income == "Medium", 2, 3)))
dane$Family_Income <- factor(dane$Family_Income, levels = c(1, 2, 3),
                             labels = c("Low", "Medium", "High"), ordered = TRUE)

dane$Teacher_Quality <- ifelse(is.na(dane$Teacher_Quality), NA,
                               ifelse(dane$Teacher_Quality == "Low", 1,
                                      ifelse(dane$Teacher_Quality == "Medium", 2, 3)))
dane$Teacher_Quality <- factor(dane$Teacher_Quality, levels = c(1, 2, 3),
                               labels = c("Low", "Medium", "High"), ordered = TRUE)

dane$School_Type <- ifelse(dane$School_Type == "Public", 1, 2)
dane$School_Type <- factor(dane$School_Type, levels = c(1, 2), labels = c("Public", "Private"))

dane$Peer_Influence <- ifelse(dane$Peer_Influence == "Negative", 1,
                              ifelse(dane$Peer_Influence == "Neutral", 2, 3))
dane$Peer_Influence <- factor(dane$Peer_Influence, levels = c(1, 2, 3),
                              labels = c("Negative", "Neutral", "Positive"), ordered = TRUE)

dane$Learning_Disabilities <- ifelse(dane$Learning_Disabilities == "No", 0, 1)
dane$Learning_Disabilities <- factor(dane$Learning_Disabilities, levels = c(0, 1),
                                     labels = c("No", "Yes"))

dane$Parental_Education_Level <- ifelse(is.na(dane$Parental_Education_Level), NA,
                                        ifelse(dane$Parental_Education_Level == "High School", 1,
                                        ifelse(dane$Parental_Education_Level == "College", 2, 3)))
dane$Parental_Education_Level <- factor(dane$Parental_Education_Level, levels = c(1, 2, 3),
                                        labels = c("High School", "College", "Postgraduate"),
                                        ordered = TRUE)

dane$Distance_from_Home <- ifelse(is.na(dane$Distance_from_Home), NA,
                                  ifelse(dane$Distance_from_Home == "Far", 1,
                                         ifelse(dane$Distance_from_Home == "Moderate", 2, 3)))
dane$Distance_from_Home <- factor(dane$Distance_from_Home, levels = c(1, 2, 3),
                                  labels = c("Far", "Moderate", "Near"), ordered = TRUE)

dane$Gender <- ifelse(dane$Gender == "Female", 1, 2)
dane$Gender <- factor(dane$Gender, levels = c(1, 2), labels = c("Female", "Male"))
```

### 1.2.2. Walidacje

Stworzone zostały reguły walidacyjne dla każdej zmiennej. Dla zmiennych ilościowych wprowadzono regułę wymagającego, aby zmienna była liczbą oraz określono przedziały, w których mogą się znajdować wynikające z charakteru zmiennej, np. liczba godzin snu musi być większa lub równa 0, ale nie większa niż 24 ze względu liczbę godzin w ciągu dnia. Dla zmiennych jakościowych wprowadzono ograniczenia wymagające od nich bycia zmienną factor oraz sprawdzające czy obserwacje opisane są jedną z możliwych odpowiedzi dla dane zmiennej.

```{r}
# Stworzenie reguł walidacyjnych

rules <- check_that(dane,
  
  # Reguły dla zmiennej Hours_Studied
  
  is.numeric(Hours_Studied), #1
  Hours_Studied >= 0, #2
  Hours_Studied <= 168, #3
  
  # Reguły dla zmiennej Attendance
  
  is.numeric(Attendance), #4
  Attendance >= 0, #5
  Attendance <= 100, #6
  
  # Reguły dla zmiennej Parental_Involvement
  
  is.factor(Parental_Involvement), #7
  Parental_Involvement %in% c("Low", "Medium", "High"), #8
  
  # Reguły dla zmiennej Access_to_Resources
  
  is.factor(Access_to_Resources), #9
  Access_to_Resources %in% c("Low", "Medium", "High"), #10
  
  # Reguły dla zmiennej Extracurricular_Activities
  
  is.factor(Extracurricular_Activities), #11
  Extracurricular_Activities %in% c("No", "Yes"), #12
  
  # Reguły dla zmiennej Sleep_Hours
  
  is.numeric(Sleep_Hours), #13
  Sleep_Hours >= 0, #14
  Sleep_Hours <= 24, #15
  
  # Reguły dla zmiennej Previous_Scores
  
  is.numeric(Previous_Scores), #16
  Previous_Scores >= 0, #17
  Previous_Scores <= 100, #18
  
  # Reguły dla zmiennej Motivation_Level
  
  is.factor(Motivation_Level), #19
  Motivation_Level %in% c("Low", "Medium", "High"), #20
  
  # Reguły dla zmiennej Internet_Access
  
  is.factor(Internet_Access), #21
  Internet_Access %in% c("No", "Yes"), #22
  
  # Reguły dla zmiennej Tutoring_Sessions
  
  is.numeric(Tutoring_Sessions), #23
  Tutoring_Sessions >= 0, #24
  (Tutoring_Sessions - floor(Tutoring_Sessions)) == 0, #25
  
  # Reguły dla zmiennej Family_Income
  
  is.factor(Family_Income), #26
  Family_Income %in% c("Low", "Medium", "High"), #27
  
  # Reguły dla zmiennej Teacher_Quality
  
  is.factor(Teacher_Quality), #28
  Teacher_Quality %in% c("Low", "Medium", "High"), #29
  
  # Reguły dla zmiennej School_Type
  
  is.factor(School_Type), #30
  School_Type %in% c("Public", "Private"), #31
  
  # Reguły dla zmiennej Peer_Influence
  
  is.factor(Peer_Influence), #32
  Peer_Influence %in% c("Negative", "Neutral", "Positive"), #33
  
  # Reguły dla zmiennej Physical_Activity
  
  is.numeric(Physical_Activity), #34
  Physical_Activity >= 0, #35
  Physical_Activity <= 168, #36
  
  # Reguły dla zmiennej Learning_Disabilities
  
  is.factor(Learning_Disabilities), #37
  Learning_Disabilities %in% c("No", "Yes"), #38
  
  # Reguły dla zmiennej Parental_Education_Level
  
  is.factor(Parental_Education_Level), #39
  Parental_Education_Level %in% c("High School", "College", "Postgraduate"), #40
  
  # Reguły dla zmiennej Distance_from_Home
  
  is.factor(Distance_from_Home), #41
  Distance_from_Home %in% c("Far", "Moderate", "Near"), #42
  
  # Reguły dla zmiennej Gender
  
  is.factor(Gender), #43
  Gender %in% c("Female", "Male"), #44
  
  # Reguły dla zmiennej Exam_Score
  
  is.numeric(Exam_Score), #45
  Exam_Score >= 0, #46
  Exam_Score <= 100 #47
)

summary(rules)
```

Istnieje jedna obserwacja, w której jedna zmienna wykracza poza swój dozwolony przedział.

```{r}
dane %>%
  filter(!(Exam_Score >= 0 & Exam_Score <= 100)) %>%
  select(Exam_Score)
```

W jednej obserwacji wynik z egzaminu (zmienna Exam_Score) został wprowadzony jako 101, mimo że wynik może wynosić maksymalnie 100. To najprawdopodobniej błąd przy wprowadzaniu danych, dlatego ta wartość zostanie zmieniona na 100.

```{r}
dane$Exam_Score <- ifelse(dane$Exam_Score > 100, 100, dane$Exam_Score)
```

Poza tym nie ma żadnych innych obserwacji, które nie spełniają którejś z reguł walidacyjnych.

### 1.2.3. Imputacje

Zestaw posiada wiele braków danych, dlatego konieczne będzie dokonanie ich imputacji. Wszystkie zmienne zostały zimputowane za pomocą metody MICE, czyli wielowymiarowego wypełniania przez równania łańcuchowe.

```{r imputacje}

# Imputacja zmiennej Sleep_Hours

imp1 <- imputate_na(dane, Sleep_Hours, Hours_Studied,
                    method = "mice", seed = 101)
plot(imp1)
dane$Sleep_Hours <- imputate_na(dane, Sleep_Hours, Hours_Studied,
                                method = "mice", seed = 101, no_attrs = TRUE)

# Imputacja zmiennej Family_Income

imp2 <- imputate_na(dane, Family_Income, Extracurricular_Activities,
                    method = "mice", seed = 102)
plot(imp2)
dane$Family_Income <- imputate_na(dane, Family_Income, Extracurricular_Activities,
                                  method = "mice", seed = 102, no_attrs = TRUE)

# Imputacja zmiennej Teacher_Quality

imp3 <- imputate_na(dane, Teacher_Quality, Previous_Scores,
                    method = "mice", seed = 103)
plot(imp3)
dane$Teacher_Quality <- imputate_na(dane, Teacher_Quality, Previous_Scores,
                                    method = "mice", seed = 103, no_attrs = TRUE)

# Imputacja zmiennej Parental_Education_Level

imp4 <- imputate_na(dane, Parental_Education_Level, Family_Income,
                    method = "mice", seed = 104)
plot(imp4)
dane$Parental_Education_Level <- imputate_na(dane, Parental_Education_Level, Family_Income,
                                             method = "mice", seed = 104, no_attrs = TRUE)

# Imputacja zmiennej Distance_from_Home

imp5 <- imputate_na(dane, Distance_from_Home, Sleep_Hours,
                    method = "mice", seed = 105)
plot(imp5)
dane$Distance_from_Home <- imputate_na(dane, Distance_from_Home, Sleep_Hours,
                                       method = "mice", seed = 105, no_attrs = TRUE)

# Imputacja zmiennej Exam_Score

imp6 <- imputate_na(dane, Exam_Score, Previous_Scores,
                    method = "mice", seed = 106)
plot(imp6)
dane$Exam_Score <- imputate_na(dane, Exam_Score, Previous_Scores,
                               method = "mice", seed = 106, no_attrs = TRUE)
```

Po wykonaniu tych imputacji usunięto wszystkie braki danych.

```{r}
for(i in 1:ncol(dane)) {
  cat("Liczba braków danych w kolumnie", names(dane[, i]), ":", sum(is.na(dane[ , i])), "\n")
}
```

# 2. Wizualizacje danych

W tym rozdziale przedstawione zostały różne formy wizualizacji danych. Wizualizacje oparte są na pakiecie ggplot2 oraz plotly. Przed stworzeniem wizualizacji zdefiniowano motyw, który będzie wykorzystywany we wszystkich wykresach, w celu ujednolicenia stylu.

```{r}
my_theme <- theme_minimal() +
  theme(plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
        axis.title = element_text(size = 14),
        axis.text = element_text(size = 11))
```


## 2.1. Wykresy pudełkowe

W tym podrozdziale przedstawiono wykresy pudełkowe dla zmiennych ilościowych zestawu danych. Najpierw zostały zdefiniowane poniższym kodem.

```{r}

# Wykres pudełkowy godzin nauki

wykres1 <- ggplot(dane, aes(y = Hours_Studied)) +
  geom_boxplot() +
  labs(title = "Wykres pudełkowy godzin nauki",
       y = "Godziny nauki") +
  my_theme

# Wykres pudełkowy wyników z egzaminu

wykres2 <- ggplot(dane, aes(y = Exam_Score)) +
  geom_boxplot() +
  labs(title = "Wykres pudełkowy wyników z egzaminu",
       y = "Wynik z egzaminu [%]") +
  my_theme

# Wykres pudełkowy obecności

wykres3 <- ggplot(dane, aes(y = Attendance)) +
  geom_boxplot() +
  labs(title = "Wykres pudełkowy obecności",
       y = "Obecność [%]") +
  my_theme

# Wykres pudełkowy średniej liczby godzin snu w ciągu nocy

wykres4 <- ggplot(dane, aes(y = Sleep_Hours)) +
  geom_boxplot() +
  labs(title = "Wykres pudełkowy średniej liczby godzin snu w ciągu nocy",
       y = "Średnia liczba godzin snu w ciągu nocy") +
  my_theme

# Wykres pudełkowy wyników z poprzednich egzaminów

wykres5 <- ggplot(dane, aes(y = Previous_Scores)) +
  geom_boxplot() +
  labs(title = "Wykres pudełkowy wyników z poprzednich egzaminów",
       y = "Wyniki z poprzednich egzaminów [%]") +
  my_theme

# Wykres pudełkowy liczby sesji korepetycji w miesiącu

wykres6 <- ggplot(dane, aes(y = Tutoring_Sessions)) +
  geom_boxplot() +
  labs(title = "Wykres pudełkowy liczby sesji korepetycji w miesiącu",
       y = "Liczba sesji korepetycji w miesiącu") +
  my_theme

# Wykres pudełkowy średniej liczby godzin aktywności fizycznej w tygodniu

wykres7 <- ggplot(dane, aes(y = Physical_Activity)) +
  geom_boxplot() +
  labs(title = "Wykres pudełkowy średniej liczby godzin aktywności fizycznej w tygodniu",
       y = "Średnia liczba godzin aktywności fizycznej w tygodniu") +
  my_theme

```

Następnie przetworzono je do formy interaktywnej za pomocą pakietu plotly.

```{r}
ggplotly(wykres1)

ggplotly(wykres2)

ggplotly(wykres3)

ggplotly(wykres4)

ggplotly(wykres5)

ggplotly(wykres6)

ggplotly(wykres7)
```



## 2.2. Histogramy

W tym podrozdziale przedstawione zostały rozkłady zmiennych ilościowych za pomocą histogramów. Najpierw wykresy zostaną zdefiniowane, a następnie zwizualizowane za pomocą pakietu plotly.

```{r}
# Histogram godzin nauki w tygodniu

wykres8 <- ggplot(dane, aes(x = Hours_Studied)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram godzin nauki w tygodniu", 
       x = "Liczba godzin nauki", 
       y = "Liczba osób") +
  my_theme


# Histogram obecności na zajęciach

wykres9 <- ggplot(dane, aes(x = Attendance)) +
  geom_histogram(binwidth = 5, fill = "red", color = "black", alpha = 0.7) +
  labs(title = "Histogram obecności na zajęciach", 
       x = "Obecność [%]", 
       y = "Liczba osób") +
  my_theme

# Histogram średniej liczby godzin snu w ciągu nocy

wykres10 <- ggplot(dane, aes(x = Sleep_Hours)) +
  geom_histogram(binwidth = 1, fill = "pink", color = "black", alpha = 0.7) +
  labs(title = "Histogram średniej liczby godzin snu w ciągu nocy", 
       x = "Liczba godzin snu", 
       y = "Liczba osób") +
  my_theme

# Histogram wyników z poprzednich egzaminów

wykres11 <- ggplot(dane, aes(x = Previous_Scores)) +
  geom_histogram(binwidth = 5, fill = "green", color = "black", alpha = 0.7) +
  labs(title = "Histogram wyników z poprzednich egzaminów", 
       x = "Wyniki [%]", 
       y = "Liczba osób") +
  my_theme

# Histogram liczby sesji korepetycji w miesiącu

wykres12 <- ggplot(dane, aes(x = Tutoring_Sessions)) +
  geom_histogram(binwidth = 1, fill = "purple", color = "black", alpha = 0.7) +
  labs(title = "Histogram liczby sesji korepetycji w miesiącu", 
       x = "Liczba sesji", 
       y = "Liczba osób") +
  my_theme

# Histogram średniej liczby godzin aktywności fizycznej w tygodniu

wykres13 <- ggplot(dane, aes(x = Physical_Activity)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram średniej liczby godzin aktywności fizycznej w tygodniu", 
       x = "Liczba godzin", 
       y = "Liczba osób") +
  my_theme

# Histogram wyników z egzaminu

wykres14 <- ggplot(dane, aes(x = Exam_Score)) +
  geom_histogram(binwidth = 5, fill = "brown", color = "black", alpha = 0.7) +
  labs(title = "Histogram wyników z egzaminu", 
       x = "Wynik [%]", 
       y = "Liczba osób") +
  my_theme

```

```{r}
ggplotly(wykres8)

ggplotly(wykres9)

ggplotly(wykres10)

ggplotly(wykres11)

ggplotly(wykres12)

ggplotly(wykres13)

ggplotly(wykres14)
```

## 2.3. Wykresy kolumnowe

W tym podrozdziale przedstawiono wykresy kolumnowe dla zmiennych jakościowych. Ponownie w pierwszej kolejności zostaną one zdefiniowane, a następnie zwizualizowane w interaktywny sposób.

```{r}

# parental involvement - wykres

wykres15 <- ggplot(dane, aes(x = Parental_Involvement, fill = Parental_Involvement)) +
  geom_bar(color = "black") +
  labs(title = "Zaangażowanie rodziców", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# access to resources - wykres

wykres16 <- ggplot(dane, aes(x = Access_to_Resources, fill = Access_to_Resources)) +
  geom_bar(color = "black") +
  labs(title = "Dostęp do zasobów", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# extracurricular activities - wykres

wykres17 <- ggplot(dane, aes(x = Extracurricular_Activities,
                             fill = Extracurricular_Activities)) +
  geom_bar(color = "black") +
  labs(title = "Udział w zajęciach pozalekcyjnych", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# motivation level - wykres

wykres18 <- ggplot(dane, aes(x = Motivation_Level, fill = Motivation_Level)) +
  geom_bar(color = "black") +
  labs(title = "Poziom motywacji", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# internet access - wykres

wykres19 <- ggplot(dane, aes(x = Internet_Access, fill = Internet_Access)) +
  geom_bar(color = "black") +
  labs(title = "Dostęp do internetu", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# family income - wykres

wykres20 <- ggplot(dane, aes(x = Family_Income, fill = Family_Income)) +
  geom_bar(color = "black") +
  labs(title = "Dochód rodziny", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# teacher quality - wykres

wykres21 <- ggplot(dane, aes(x = Teacher_Quality, fill = Teacher_Quality)) +
  geom_bar(color = "black") +
  labs(title = "Jakość nauczania", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# school type - wykres

wykres22 <- ggplot(dane, aes(x = School_Type, fill = School_Type)) +
  geom_bar(color = "black") +
  labs(title = "Rodzaj szkoły", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# peer influence - wykres

wykres23 <- ggplot(dane, aes(x = Peer_Influence, fill = Peer_Influence)) +
  geom_bar(color = "black") +
  labs(title = "Wpływ rówieśników", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# learning disabilities - wykres

wykres24 <- ggplot(dane, aes(x = Learning_Disabilities, fill = Learning_Disabilities)) +
  geom_bar(color = "black") +
  labs(title = "Występowanie trudności w uczeniu się", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# parental education level - wykres

wykres25 <- ggplot(dane, aes(x = Parental_Education_Level, fill = Parental_Education_Level)) +
  geom_bar(color = "black") +
  labs(title = "Poziom wykształcenia rodziców", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# distance from home - wykres

wykres26 <- ggplot(dane, aes(x = Distance_from_Home, fill = Distance_from_Home)) +
  geom_bar(color = "black") +
  labs(title = "Odległość od domu", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

# gender - wykres

wykres27 <- ggplot(dane, aes(x = Gender, fill = Gender)) +
  geom_bar(color = "black") +
  labs(title = "Płeć", x = NULL, y = "Liczba wystąpień") +
  my_theme + theme(legend.position = "none")

```

```{r}
ggplotly(wykres15)

ggplotly(wykres16)

ggplotly(wykres17)

ggplotly(wykres18)

ggplotly(wykres19)

ggplotly(wykres20)

ggplotly(wykres21)

ggplotly(wykres22)

ggplotly(wykres23)

ggplotly(wykres24)

ggplotly(wykres25)

ggplotly(wykres26)

ggplotly(wykres27)
```


## 2.4. Wykresy punktowe

Jako ostatnie przedstawiono wykresy punktowe. Każdorazowo przedstawiają one zależność między jedną zmienną a wynikami z egzaminu (Exam_Score). Procedura jest taka sama jak w poprzednich podrozdziałach.

```{r}
wykres28 <- ggplot(dane, aes(x = Hours_Studied, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "red") +
  labs(title = "Wynik egzaminu w zależności od liczby godzin spędzonych na nauce",
       x = "Liczba godzin nauki [h]",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres29 <- ggplot(dane, aes(x = Attendance, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "black") +
  labs(title = "Wynik egzaminu w zależności od obecności",
       x = "Obecność [%]",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres30 <- ggplot(dane, aes(x = Parental_Involvement, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "purple") +
  labs(title = "Wynik egzaminu w zależności od zaangażowania rodziców",
       x = "Zaangażowanie rodziców",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres31 <- ggplot(dane, aes(x = Access_to_Resources, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "grey") +
  labs(title = "Wynik egzaminu w zależności od od dostępu do zasobów naukowych",
       x = "Dostęp do zasobów",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres32 <- ggplot(dane, aes(x = Extracurricular_Activities, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "pink") +
  labs(title = "Wynik egzaminu w zależności od liczby zajęć pozalekcyjnych",
       x = "Zajęcia pozalekcyjne",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres33 <- ggplot(dane, aes(x = Sleep_Hours, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "blue") +
  labs(title = "Wynik egzaminu w zależności od liczby godzin snu",
       x = "Liczba godzin snu [h]",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres34 <- ggplot(dane, aes(x = Previous_Scores, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "green") +
  labs(title = "Wynik egzaminu w zależności od poprzednich wyników z egzaminu",
       x = "Poprzednie wyniki z egzaminu [%]",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres35 <- ggplot(dane, aes(x = Motivation_Level, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "yellow") +
  labs(title = "Wynik egzaminu w zależności od poziomu motywacji",
       x = "Poziom motywacji",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres36 <- ggplot(dane, aes(x = Internet_Access, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "brown") +
  labs(title = "Wynik egzaminu w zależności od dostępu do internetu",
       x = "Dostęp do internetu",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres37 <- ggplot(dane, aes(x = Tutoring_Sessions, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "orange") +
  labs(title = "Wynik egzaminu w zależności od ilości korepetycji",
       x = "Ilość korepetycji",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres38 <- ggplot(dane, aes(x = Family_Income, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "lightblue") +
  labs(title = "Wynik egzaminu w zależności od zarobku rodziny",
       x = "Zarobek rodziny",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres39 <- ggplot(dane, aes(x = Teacher_Quality, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "lightgreen") +
  labs(title = "Wynik egzaminu w zależności od jakości kształcenia",
       x = "Jakość kształcenia",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres40 <- ggplot(dane, aes(x = School_Type, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "darkgreen") +
  labs(title = "Wynik egzaminu w zależności od wybranego rodzaju szkoły",
       x = "Rodzaj szkoły",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres41 <- ggplot(dane, aes(x = Peer_Influence, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "darkred") +
  labs(title = "Wynik egzaminu w zależności od wpływu rówieśników",
       x = "Wpływ rówieśników",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres42 <- ggplot(dane, aes(x = Physical_Activity, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "darkblue") +
  labs(title = "Wynik egzaminu w zależności od liczby godzin spędzonych na aktywności fizycznej",
       x = "Aktywność fizyczna [h]",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres43 <- ggplot(dane, aes(x = Learning_Disabilities, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "darkorange") +
  labs(title = "Wynik egzaminu w zależności od niepełnosprawności",
       x = "Niepełnosprawność",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres44 <- ggplot(dane, aes(x = Parental_Education_Level, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "lightpink") +
  labs(title = "Wynik egzaminu w zależności od wykształcenia rodziców",
       x = "Wykształcenie rodziców",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres45 <- ggplot(dane, aes(x = Distance_from_Home, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "lightgrey") +
  labs(title = "Wynik egzaminu w zależności od odległości od domu",
       x = "Odległość od domu",
       y = "Wynik z egzaminu [%]") +
  my_theme

wykres46 <- ggplot(dane, aes(x = Gender, y = Exam_Score)) +
  geom_point(size = 3, alpha = 0.1, colour = "darkgrey") +
  labs(title = "Wynik egzaminu w zależności od płci",
       x = "Płeć",
       y = "Wynik z egzaminu [%]") +
  my_theme
```

```{r}
ggplotly(wykres28)

ggplotly(wykres29)

ggplotly(wykres30)

ggplotly(wykres31)

ggplotly(wykres32)

ggplotly(wykres33)

ggplotly(wykres34)

ggplotly(wykres35)

ggplotly(wykres36)

ggplotly(wykres37)

ggplotly(wykres38)

ggplotly(wykres39)

ggplotly(wykres40)

ggplotly(wykres41)

ggplotly(wykres42)

ggplotly(wykres43)

ggplotly(wykres44)

ggplotly(wykres45)

ggplotly(wykres46)
```

# 3. Analiza opisowa

Tekst

# 4. Wnioskowanie statystyczne

Tekst

# 5. Podsumowanie

Tekst
